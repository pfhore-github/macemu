cmake_minimum_required(VERSION 3.0)
find_package(SDL2  REQUIRED)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_BUILD_TYPE DEBUG)
set(CMAKE_CXX_FLAGS "-Og -g3 -Wall -Wextra -fsanitize=undefined -Wno-unused-parameter")
find_package(Boost REQUIRED unit_test_framework)
set(ROOT_DIR ..)
set(cmn_include ${ROOT_DIR}/include ${ROOT_DIR}/Unix ${ROOT_DIR}/new_cpu ${ROOT_DIR}/chips/include ${ROOT_DIR}/rom)
include_directories(${SDL2_INCLUDE_DIRS} ${cmn_include} include)
add_library(test_common STATIC test_main.cpp test.cpp )
target_precompile_headers(test_common PRIVATE ${ROOT_DIR}/include/include.hpp)
link_directories(..)
link_libraries(test_common new_cpu mac_hw ${SDL2_LIBRARIES} ${target_lib} boost_unit_test_framework fmt )
add_subdirectory(rom)
set(cpu_test cpu/ori.cpp cpu/cmp2.cpp cpu/chk2.cpp cpu/andi.cpp cpu/subi.cpp cpu/addi.cpp cpu/rtm.cpp cpu/callm.cpp cpu/btst.cpp cpu/bchg.cpp  cpu/bclr.cpp  cpu/bset.cpp cpu/eori.cpp  cpu/cas.cpp   cpu/cmpi.cpp cpu/cas2.cpp cpu/moves.cpp cpu/movep.cpp cpu/move.cpp  cpu/movea.cpp  cpu/negx.cpp  cpu/clr.cpp cpu/neg.cpp cpu/not.cpp cpu/nbcd.cpp  cpu/link.cpp  cpu/swap.cpp cpu/bkpt.cpp cpu/pea.cpp cpu/ext.cpp  cpu/movem.cpp cpu/tst.cpp cpu/tas.cpp cpu/illegal.cpp cpu/mulu.cpp  cpu/muls.cpp  cpu/divu.cpp cpu/divs.cpp  cpu/trap.cpp  cpu/unlk.cpp  cpu/rte.cpp  cpu/rtd.cpp  cpu/rts.cpp  cpu/trapv.cpp cpu/rtr.cpp cpu/movec.cpp  cpu/jsr.cpp cpu/jmp.cpp  cpu/chk.cpp cpu/lea.cpp  cpu/addq.cpp   cpu/subq.cpp   cpu/scc.cpp   cpu/dbcc.cpp   cpu/trapcc.cpp  cpu/bra.cpp  cpu/bsr.cpp  cpu/bcc.cpp  cpu/moveq.cpp cpu/or.cpp cpu/sbcd.cpp cpu/pack.cpp  cpu/unpk.cpp  cpu/sub.cpp  cpu/suba.cpp  cpu/subx.cpp  cpu/cmp.cpp   cpu/cmpa.cpp   cpu/eor.cpp   cpu/cmpm.cpp   cpu/and.cpp   cpu/abcd.cpp   cpu/exg.cpp   cpu/add.cpp   cpu/adda.cpp   cpu/addx.cpp  cpu/asr.cpp  cpu/lsr.cpp  cpu/roxr.cpp  cpu/ror.cpp  cpu/bftst.cpp  cpu/bfchg.cpp  cpu/bfclr.cpp  cpu/bfset.cpp cpu/asl.cpp cpu/lsl.cpp cpu/roxl.cpp cpu/rol.cpp cpu/bfextu.cpp cpu/bfexts.cpp cpu/bfffo.cpp cpu/bfins.cpp)

set(fpu_test fpu/fmove_from.cpp fpu/fint.cpp fpu/fsinh.cpp  fpu/fintrz.cpp   fpu/fsqrt.cpp fpu/flognp1.cpp  fpu/fetoxm1.cpp fpu/ftanh.cpp fpu/fatan.cpp fpu/fasin.cpp fpu/fatanh.cpp fpu/fsin.cpp fpu/ftan.cpp fpu/fetox.cpp fpu/ftwotox.cpp fpu/ftentox.cpp fpu/flogn.cpp fpu/flog10.cpp fpu/flog2.cpp fpu/fabs.cpp fpu/fcosh.cpp fpu/fneg.cpp fpu/facos.cpp fpu/fcos.cpp fpu/fgetexp.cpp fpu/fgetman.cpp fpu/fdiv.cpp fpu/fmod.cpp fpu/fadd.cpp fpu/fmul.cpp fpu/frem.cpp fpu/fscale.cpp  fpu/fsub.cpp fpu/fsincos.cpp fpu/fcmp.cpp fpu/ftst.cpp fpu/fmovecr.cpp fpu/fmove_to.cpp fpu/fmovem.cpp fpu/fscc.cpp fpu/ftrapcc.cpp  fpu/fbcc.cpp fpu/fexception.cpp )

set(CMAKE_RUNTIME_OUTPUT_DIRECTORY bin)

ADD_EXECUTABLE(test_cpu ${cpu_test} )
ADD_EXECUTABLE(test_fpu ${fpu_test} )
ADD_EXECUTABLE(hw_via hw/via.cpp )
ADD_EXECUTABLE(hw_rbv hw/rbv.cpp )
ADD_EXECUTABLE(hw_via1 hw/via1.cpp )
ADD_EXECUTABLE(hw_asc hw/asc.cpp )
ADD_EXECUTABLE(hw_iop hw/iop.cpp )
ADD_EXECUTABLE(hw_scc hw/scc.cpp )
ADD_EXECUTABLE(hw_oss hw/iifx.cpp )
